# Скрипты запуска системы 360

## Обзор

Система 360-градусной оценки персонала включает несколько скриптов для удобного запуска в различных режимах.

## Основные скрипты

### 1. `start.sh` - Универсальный скрипт запуска

Полнофункциональный скрипт с проверками окружения и множеством опций.

#### Использование:
```bash
./start.sh [опции]
```

#### Опции:
- `-h, --help` - Показать справку
- `-d, --dev` - Запуск в режиме разработки (по умолчанию)
- `-p, --production` - Запуск в продакшн режиме
- `-i, --install` - Только установка зависимостей
- `-m, --migrate` - Только выполнение миграций
- `-s, --seed` - Только выполнение сидов
- `-b, --build` - Только сборка проектов
- `-c, --check` - Только проверка окружения

#### Примеры:
```bash
# Запуск в режиме разработки
./start.sh --dev

# Запуск в продакшн режиме
./start.sh --production

# Только установка зависимостей
./start.sh --install

# Только миграции
./start.sh --migrate

# Проверка окружения
./start.sh --check
```

### 2. `dev.sh` - Быстрый запуск для разработки

Простой скрипт для быстрого запуска в режиме разработки.

#### Использование:
```bash
./dev.sh
```

#### Особенности:
- Автоматическая проверка и создание `.env` файла
- Автоматическая установка зависимостей
- Запуск backend и frontend одновременно
- Цветной вывод с эмодзи

## Режимы работы

### Режим разработки (Development)

**Команда:** `./start.sh --dev` или `./dev.sh`

**Особенности:**
- Запуск backend на порту 3001
- Запуск frontend на порту 3000
- Hot reload для обоих сервисов
- Детальные логи
- Автоматическая перезагрузка при изменениях

**URL:**
- Frontend: http://localhost:3000
- Backend API: http://localhost:3001/api

### Продакшн режим (Production)

**Команда:** `./start.sh --production`

**Особенности:**
- Сборка проектов перед запуском
- Запуск только backend (frontend через nginx)
- Выполнение миграций и сидов
- Проверка здоровья сервисов
- Graceful shutdown

**URL:**
- Frontend: http://localhost:80 (через nginx)
- Backend API: http://localhost:3001/api

## Проверки и требования

### Системные требования

- **Node.js:** версия 16 или выше
- **npm:** любая версия
- **PostgreSQL:** запущен и доступен
- **Redis:** запущен и доступен (опционально)

### Автоматические проверки

Скрипт `start.sh` выполняет следующие проверки:

1. **Node.js и npm** - проверка наличия и версии
2. **Файл .env** - проверка наличия конфигурации
3. **Зависимости** - проверка и установка node_modules
4. **База данных** - проверка подключения к PostgreSQL
5. **Миграции** - выполнение миграций БД
6. **Сиды** - заполнение начальными данными

## Устранение проблем

### Ошибка "Node.js не установлен"
```bash
# Установка Node.js на macOS
brew install node

# Установка Node.js на Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs
```

### Ошибка "Файл .env не найден"
```bash
# Скопировать пример конфигурации
cp env.example .env

# Отредактировать настройки
nano .env
```

### Ошибка подключения к базе данных
1. Убедитесь, что PostgreSQL запущен
2. Проверьте настройки в `.env` файле
3. Создайте базу данных и пользователя:
```bash
# Подключитесь к PostgreSQL
psql -U postgres

# Создайте базу данных
CREATE DATABASE assessment360;

# Создайте пользователя
CREATE USER assessment_user WITH PASSWORD 'your_password';

# Дайте права пользователю
GRANT ALL PRIVILEGES ON DATABASE assessment360 TO assessment_user;
```

### Ошибка "Port already in use"
```bash
# Найти процесс на порту
lsof -i :3000
lsof -i :3001

# Убить процесс
kill -9 <PID>
```

## Логирование

### Уровни логов
- `[INFO]` - Информационные сообщения (синий)
- `[SUCCESS]` - Успешные операции (зеленый)
- `[WARNING]` - Предупреждения (желтый)
- `[ERROR]` - Ошибки (красный)

### Просмотр логов
```bash
# Логи backend
tail -f backend/logs/app.log

# Логи frontend (в режиме разработки)
# Логи выводятся в консоль
```

## Интеграция с IDE

### VS Code
Добавьте в `.vscode/launch.json`:
```json
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Launch 360 System",
            "type": "node",
            "request": "launch",
            "program": "${workspaceFolder}/start.sh",
            "args": ["--dev"],
            "console": "integratedTerminal"
        }
    ]
}
```

### IntelliJ IDEA / WebStorm
1. Создайте новую конфигурацию "Run External Tool"
2. Program: `./start.sh`
3. Arguments: `--dev`
4. Working directory: корень проекта

## Автоматизация

### Добавление в PATH
```bash
# Добавить в ~/.bashrc или ~/.zshrc
export PATH="$PATH:/path/to/your/360/project"

# Теперь можно запускать из любой директории
360-start --dev
```

### Создание алиасов
```bash
# Добавить в ~/.bashrc или ~/.zshrc
alias 360-dev='cd /path/to/your/360/project && ./dev.sh'
alias 360-prod='cd /path/to/your/360/project && ./start.sh --production'
```

## Безопасность

### Переменные окружения
- Никогда не коммитьте `.env` файл в git
- Используйте `.env.example` как шаблон
- Храните секреты в безопасном месте

### Права доступа
```bash
# Установить правильные права на скрипты
chmod +x start.sh dev.sh

# Установить права только для владельца на .env
chmod 600 .env
```

## Мониторинг

### Проверка состояния системы
```bash
# Проверка процессов
ps aux | grep node

# Проверка портов
netstat -tulpn | grep :300

# Проверка логов
tail -f backend/logs/app.log
```

### Автоматический перезапуск
```bash
# Использовать nodemon для разработки
npm install -g nodemon
nodemon start.sh --dev
```

## Поддержка

При возникновении проблем:

1. Проверьте логи системы
2. Убедитесь в корректности настроек в `.env`
3. Проверьте подключение к базе данных
4. Перезапустите систему с флагом `--check`

Для получения помощи обратитесь к документации проекта или создайте issue в репозитории. 